function Y(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */Y=function(){return r};var r={},n=Object.prototype,e=n.hasOwnProperty,t=typeof Symbol=="function"?Symbol:{},i=t.iterator||"@@iterator",o=t.asyncIterator||"@@asyncIterator",a=t.toStringTag||"@@toStringTag";function s(c,u,h){return Object.defineProperty(c,u,{value:h,enumerable:!0,configurable:!0,writable:!0}),c[u]}try{s({},"")}catch{s=function(h,d,v){return h[d]=v}}function l(c,u,h,d){var v=u&&u.prototype instanceof O?u:O,p=Object.create(v.prototype),k=new $(d||[]);return p._invoke=function(F,T,b){var A="suspendedStart";return function(S,se){if(A==="executing")throw new Error("Generator is already running");if(A==="completed"){if(S==="throw")throw se;return ae()}for(b.method=S,b.arg=se;;){var ue=b.delegate;if(ue){var H=oe(ue,b);if(H){if(H===g)continue;return H}}if(b.method==="next")b.sent=b._sent=b.arg;else if(b.method==="throw"){if(A==="suspendedStart")throw A="completed",b.arg;b.dispatchException(b.arg)}else b.method==="return"&&b.abrupt("return",b.arg);A="executing";var V=f(F,T,b);if(V.type==="normal"){if(A=b.done?"completed":"suspendedYield",V.arg===g)continue;return{value:V.arg,done:b.done}}V.type==="throw"&&(A="completed",b.method="throw",b.arg=V.arg)}}}(c,h,k),p}function f(c,u,h){try{return{type:"normal",arg:c.call(u,h)}}catch(d){return{type:"throw",arg:d}}}r.wrap=l;var g={};function O(){}function N(){}function M(){}var x={};s(x,i,function(){return this});var D=Object.getPrototypeOf,P=D&&D(D(J([])));P&&P!==n&&e.call(P,i)&&(x=P);var I=M.prototype=O.prototype=Object.create(x);function ie(c){["next","throw","return"].forEach(function(u){s(c,u,function(h){return this._invoke(u,h)})})}function R(c,u){function h(v,p,k,F){var T=f(c[v],c,p);if(T.type!=="throw"){var b=T.arg,A=b.value;return A&&typeof A=="object"&&e.call(A,"__await")?u.resolve(A.__await).then(function(S){h("next",S,k,F)},function(S){h("throw",S,k,F)}):u.resolve(A).then(function(S){b.value=S,k(b)},function(S){return h("throw",S,k,F)})}F(T.arg)}var d;this._invoke=function(v,p){function k(){return new u(function(F,T){h(v,p,F,T)})}return d=d?d.then(k,k):k()}}function oe(c,u){var h=c.iterator[u.method];if(h===void 0){if(u.delegate=null,u.method==="throw"){if(c.iterator.return&&(u.method="return",u.arg=void 0,oe(c,u),u.method==="throw"))return g;u.method="throw",u.arg=new TypeError("The iterator does not provide a 'throw' method")}return g}var d=f(h,c.iterator,u.arg);if(d.type==="throw")return u.method="throw",u.arg=d.arg,u.delegate=null,g;var v=d.arg;return v?v.done?(u[c.resultName]=v.value,u.next=c.nextLoc,u.method!=="return"&&(u.method="next",u.arg=void 0),u.delegate=null,g):v:(u.method="throw",u.arg=new TypeError("iterator result is not an object"),u.delegate=null,g)}function Se(c){var u={tryLoc:c[0]};1 in c&&(u.catchLoc=c[1]),2 in c&&(u.finallyLoc=c[2],u.afterLoc=c[3]),this.tryEntries.push(u)}function q(c){var u=c.completion||{};u.type="normal",delete u.arg,c.completion=u}function $(c){this.tryEntries=[{tryLoc:"root"}],c.forEach(Se,this),this.reset(!0)}function J(c){if(c){var u=c[i];if(u)return u.call(c);if(typeof c.next=="function")return c;if(!isNaN(c.length)){var h=-1,d=function v(){for(;++h<c.length;)if(e.call(c,h))return v.value=c[h],v.done=!1,v;return v.value=void 0,v.done=!0,v};return d.next=d}}return{next:ae}}function ae(){return{value:void 0,done:!0}}return N.prototype=M,s(I,"constructor",M),s(M,"constructor",N),N.displayName=s(M,a,"GeneratorFunction"),r.isGeneratorFunction=function(c){var u=typeof c=="function"&&c.constructor;return!!u&&(u===N||(u.displayName||u.name)==="GeneratorFunction")},r.mark=function(c){return Object.setPrototypeOf?Object.setPrototypeOf(c,M):(c.__proto__=M,s(c,a,"GeneratorFunction")),c.prototype=Object.create(I),c},r.awrap=function(c){return{__await:c}},ie(R.prototype),s(R.prototype,o,function(){return this}),r.AsyncIterator=R,r.async=function(c,u,h,d,v){v===void 0&&(v=Promise);var p=new R(l(c,u,h,d),v);return r.isGeneratorFunction(u)?p:p.next().then(function(k){return k.done?k.value:p.next()})},ie(I),s(I,a,"Generator"),s(I,i,function(){return this}),s(I,"toString",function(){return"[object Generator]"}),r.keys=function(c){var u=[];for(var h in c)u.push(h);return u.reverse(),function d(){for(;u.length;){var v=u.pop();if(v in c)return d.value=v,d.done=!1,d}return d.done=!0,d}},r.values=J,$.prototype={constructor:$,reset:function(u){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(q),!u)for(var h in this)h.charAt(0)==="t"&&e.call(this,h)&&!isNaN(+h.slice(1))&&(this[h]=void 0)},stop:function(){this.done=!0;var u=this.tryEntries[0].completion;if(u.type==="throw")throw u.arg;return this.rval},dispatchException:function(u){if(this.done)throw u;var h=this;function d(b,A){return k.type="throw",k.arg=u,h.next=b,A&&(h.method="next",h.arg=void 0),!!A}for(var v=this.tryEntries.length-1;v>=0;--v){var p=this.tryEntries[v],k=p.completion;if(p.tryLoc==="root")return d("end");if(p.tryLoc<=this.prev){var F=e.call(p,"catchLoc"),T=e.call(p,"finallyLoc");if(F&&T){if(this.prev<p.catchLoc)return d(p.catchLoc,!0);if(this.prev<p.finallyLoc)return d(p.finallyLoc)}else if(F){if(this.prev<p.catchLoc)return d(p.catchLoc,!0)}else{if(!T)throw new Error("try statement without catch or finally");if(this.prev<p.finallyLoc)return d(p.finallyLoc)}}}},abrupt:function(u,h){for(var d=this.tryEntries.length-1;d>=0;--d){var v=this.tryEntries[d];if(v.tryLoc<=this.prev&&e.call(v,"finallyLoc")&&this.prev<v.finallyLoc){var p=v;break}}p&&(u==="break"||u==="continue")&&p.tryLoc<=h&&h<=p.finallyLoc&&(p=null);var k=p?p.completion:{};return k.type=u,k.arg=h,p?(this.method="next",this.next=p.finallyLoc,g):this.complete(k)},complete:function(u,h){if(u.type==="throw")throw u.arg;return u.type==="break"||u.type==="continue"?this.next=u.arg:u.type==="return"?(this.rval=this.arg=u.arg,this.method="return",this.next="end"):u.type==="normal"&&h&&(this.next=h),g},finish:function(u){for(var h=this.tryEntries.length-1;h>=0;--h){var d=this.tryEntries[h];if(d.finallyLoc===u)return this.complete(d.completion,d.afterLoc),q(d),g}},catch:function(u){for(var h=this.tryEntries.length-1;h>=0;--h){var d=this.tryEntries[h];if(d.tryLoc===u){var v=d.completion;if(v.type==="throw"){var p=v.arg;q(d)}return p}}throw new Error("illegal catch attempt")},delegateYield:function(u,h,d){return this.delegate={iterator:J(u),resultName:h,nextLoc:d},this.method==="next"&&(this.arg=void 0),g}},r}function ce(r,n,e,t,i,o,a){try{var s=r[o](a),l=s.value}catch(f){e(f);return}s.done?n(l):Promise.resolve(l).then(t,i)}function Ce(r){return function(){var n=this,e=arguments;return new Promise(function(t,i){var o=r.apply(n,e);function a(l){ce(o,t,i,a,s,"next",l)}function s(l){ce(o,t,i,a,s,"throw",l)}a(void 0)})}}function C(r){return Le(r)||Be(r)||ne(r)||Ne()}function Ne(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Be(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function Le(r){if(Array.isArray(r))return Q(r)}function De(r,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(n&&n.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),n&&Z(r,n)}function Z(r,n){return Z=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,i){return t.__proto__=i,t},Z(r,n)}function Ie(r){var n=je();return function(){var t=z(r),i;if(n){var o=z(this).constructor;i=Reflect.construct(t,arguments,o)}else i=t.apply(this,arguments);return xe(this,i)}}function xe(r,n){if(n&&(typeof n=="object"||typeof n=="function"))return n;if(n!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ve(r)}function Ve(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function je(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function z(r){return z=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},z(r)}function B(r,n){return Pe(r)||_e(r,n)||ne(r,n)||Ke()}function Ke(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _e(r,n){var e=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(e!=null){var t=[],i=!0,o=!1,a,s;try{for(e=e.call(r);!(i=(a=e.next()).done)&&(t.push(a.value),!(n&&t.length===n));i=!0);}catch(l){o=!0,s=l}finally{try{!i&&e.return!=null&&e.return()}finally{if(o)throw s}}return t}}function Pe(r){if(Array.isArray(r))return r}function E(r,n,e){return n in r?Object.defineProperty(r,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):r[n]=e,r}function w(r,n){var e=typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(!e){if(Array.isArray(r)||(e=ne(r))||n&&r&&typeof r.length=="number"){e&&(r=e);var t=0,i=function(){};return{s:i,n:function(){return t>=r.length?{done:!0}:{done:!1,value:r[t++]}},e:function(f){throw f},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o=!0,a=!1,s;return{s:function(){e=e.call(r)},n:function(){var f=e.next();return o=f.done,f},e:function(f){a=!0,s=f},f:function(){try{!o&&e.return!=null&&e.return()}finally{if(a)throw s}}}}function ne(r,n){if(r){if(typeof r=="string")return Q(r,n);var e=Object.prototype.toString.call(r).slice(8,-1);if(e==="Object"&&r.constructor&&(e=r.constructor.name),e==="Map"||e==="Set")return Array.from(r);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Q(r,n)}}function Q(r,n){(n==null||n>r.length)&&(n=r.length);for(var e=0,t=new Array(n);e<n;e++)t[e]=r[e];return t}function y(r,n){if(!(r instanceof n))throw new TypeError("Cannot call a class as a function")}function le(r,n){for(var e=0;e<n.length;e++){var t=n[e];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(r,t.key,t)}}function m(r,n,e){return n&&le(r.prototype,n),e&&le(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}var Re=function(){function r(n,e,t){y(this,r),this.eventTarget=n,this.eventName=e,this.eventOptions=t,this.unorderedBindings=new Set}return m(r,[{key:"connect",value:function(){this.eventTarget.addEventListener(this.eventName,this,this.eventOptions)}},{key:"disconnect",value:function(){this.eventTarget.removeEventListener(this.eventName,this,this.eventOptions)}},{key:"bindingConnected",value:function(e){this.unorderedBindings.add(e)}},{key:"bindingDisconnected",value:function(e){this.unorderedBindings.delete(e)}},{key:"handleEvent",value:function(e){var t=Ue(e),i=w(this.bindings),o;try{for(i.s();!(o=i.n()).done;){var a=o.value;if(t.immediatePropagationStopped)break;a.handleEvent(t)}}catch(s){i.e(s)}finally{i.f()}}},{key:"hasBindings",value:function(){return this.unorderedBindings.size>0}},{key:"bindings",get:function(){return Array.from(this.unorderedBindings).sort(function(e,t){var i=e.index,o=t.index;return i<o?-1:i>o?1:0})}}]),r}();function Ue(r){if("immediatePropagationStopped"in r)return r;var n=r.stopImmediatePropagation;return Object.assign(r,{immediatePropagationStopped:!1,stopImmediatePropagation:function(){this.immediatePropagationStopped=!0,n.call(this)}})}var ze=function(){function r(n){y(this,r),this.application=n,this.eventListenerMaps=new Map,this.started=!1}return m(r,[{key:"start",value:function(){this.started||(this.started=!0,this.eventListeners.forEach(function(e){return e.connect()}))}},{key:"stop",value:function(){this.started&&(this.started=!1,this.eventListeners.forEach(function(e){return e.disconnect()}))}},{key:"eventListeners",get:function(){return Array.from(this.eventListenerMaps.values()).reduce(function(e,t){return e.concat(Array.from(t.values()))},[])}},{key:"bindingConnected",value:function(e){this.fetchEventListenerForBinding(e).bindingConnected(e)}},{key:"bindingDisconnected",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.fetchEventListenerForBinding(e).bindingDisconnected(e),t&&this.clearEventListenersForBinding(e)}},{key:"handleError",value:function(e,t){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.application.handleError(e,"Error ".concat(t),i)}},{key:"clearEventListenersForBinding",value:function(e){var t=this.fetchEventListenerForBinding(e);t.hasBindings()||(t.disconnect(),this.removeMappedEventListenerFor(e))}},{key:"removeMappedEventListenerFor",value:function(e){var t=e.eventTarget,i=e.eventName,o=e.eventOptions,a=this.fetchEventListenerMapForEventTarget(t),s=this.cacheKey(i,o);a.delete(s),a.size==0&&this.eventListenerMaps.delete(t)}},{key:"fetchEventListenerForBinding",value:function(e){var t=e.eventTarget,i=e.eventName,o=e.eventOptions;return this.fetchEventListener(t,i,o)}},{key:"fetchEventListener",value:function(e,t,i){var o=this.fetchEventListenerMapForEventTarget(e),a=this.cacheKey(t,i),s=o.get(a);return s||(s=this.createEventListener(e,t,i),o.set(a,s)),s}},{key:"createEventListener",value:function(e,t,i){var o=new Re(e,t,i);return this.started&&o.connect(),o}},{key:"fetchEventListenerMapForEventTarget",value:function(e){var t=this.eventListenerMaps.get(e);return t||(t=new Map,this.eventListenerMaps.set(e,t)),t}},{key:"cacheKey",value:function(e,t){var i=[e];return Object.keys(t).sort().forEach(function(o){i.push("".concat(t[o]?"":"!").concat(o))}),i.join(":")}}]),r}(),Ge={stop:function(n){var e=n.event,t=n.value;return t&&e.stopPropagation(),!0},prevent:function(n){var e=n.event,t=n.value;return t&&e.preventDefault(),!0},self:function(n){var e=n.event,t=n.value,i=n.element;return t?i===e.target:!0}},We=/^(?:(?:([^.]+?)\+)?(.+?)(?:\.(.+?))?(?:@(window|document))?->)?(.+?)(?:#([^:]+?))(?::(.+))?$/;function qe(r){var n=r.trim(),e=n.match(We)||[],t=e[2],i=e[3];return i&&!["keydown","keyup","keypress"].includes(t)&&(t+=".".concat(i),i=""),{eventTarget:$e(e[4]),eventName:t,eventOptions:e[7]?Je(e[7]):{},identifier:e[5],methodName:e[6],keyFilter:e[1]||i}}function $e(r){if(r=="window")return window;if(r=="document")return document}function Je(r){return r.split(":").reduce(function(n,e){return Object.assign(n,E({},e.replace(/^!/,""),!/^!/.test(e)))},{})}function He(r){if(r==window)return"window";if(r==document)return"document"}function re(r){return r.replace(/(?:[_-])([a-z0-9])/g,function(n,e){return e.toUpperCase()})}function X(r){return re(r.replace(/--/g,"-").replace(/__/g,"_"))}function K(r){return r.charAt(0).toUpperCase()+r.slice(1)}function ke(r){return r.replace(/([A-Z])/g,function(n,e){return"-".concat(e.toLowerCase())})}function Ye(r){return r.match(/[^\s]+/g)||[]}function he(r){return r!=null}function ee(r,n){return Object.prototype.hasOwnProperty.call(r,n)}var fe=["meta","ctrl","alt","shift"],Ze=function(){function r(n,e,t,i){y(this,r),this.element=n,this.index=e,this.eventTarget=t.eventTarget||n,this.eventName=t.eventName||Qe(n)||U("missing event name"),this.eventOptions=t.eventOptions||{},this.identifier=t.identifier||U("missing identifier"),this.methodName=t.methodName||U("missing method name"),this.keyFilter=t.keyFilter||"",this.schema=i}return m(r,[{key:"toString",value:function(){var e=this.keyFilter?".".concat(this.keyFilter):"",t=this.eventTargetName?"@".concat(this.eventTargetName):"";return"".concat(this.eventName).concat(e).concat(t,"->").concat(this.identifier,"#").concat(this.methodName)}},{key:"shouldIgnoreKeyboardEvent",value:function(e){if(!this.keyFilter)return!1;var t=this.keyFilter.split("+");if(this.keyFilterDissatisfied(e,t))return!0;var i=t.filter(function(o){return!fe.includes(o)})[0];return i?(ee(this.keyMappings,i)||U("contains unknown key filter: ".concat(this.keyFilter)),this.keyMappings[i].toLowerCase()!==e.key.toLowerCase()):!1}},{key:"shouldIgnoreMouseEvent",value:function(e){if(!this.keyFilter)return!1;var t=[this.keyFilter];return!!this.keyFilterDissatisfied(e,t)}},{key:"params",get:function(){for(var e={},t=new RegExp("^data-".concat(this.identifier,"-(.+)-param$"),"i"),i=0,o=Array.from(this.element.attributes);i<o.length;i++){var a=o[i],s=a.name,l=a.value,f=s.match(t),g=f&&f[1];g&&(e[re(g)]=Xe(l))}return e}},{key:"eventTargetName",get:function(){return He(this.eventTarget)}},{key:"keyMappings",get:function(){return this.schema.keyMappings}},{key:"keyFilterDissatisfied",value:function(e,t){var i=fe.map(function(g){return t.includes(g)}),o=B(i,4),a=o[0],s=o[1],l=o[2],f=o[3];return e.metaKey!==a||e.ctrlKey!==s||e.altKey!==l||e.shiftKey!==f}}],[{key:"forToken",value:function(e,t){return new this(e.element,e.index,qe(e.content),t)}}]),r}(),de={a:function(){return"click"},button:function(){return"click"},form:function(){return"submit"},details:function(){return"toggle"},input:function(n){return n.getAttribute("type")=="submit"?"click":"input"},select:function(){return"change"},textarea:function(){return"input"}};function Qe(r){var n=r.tagName.toLowerCase();if(n in de)return de[n](r)}function U(r){throw new Error(r)}function Xe(r){try{return JSON.parse(r)}catch{return r}}var et=function(){function r(n,e){y(this,r),this.context=n,this.action=e}return m(r,[{key:"index",get:function(){return this.action.index}},{key:"eventTarget",get:function(){return this.action.eventTarget}},{key:"eventOptions",get:function(){return this.action.eventOptions}},{key:"identifier",get:function(){return this.context.identifier}},{key:"handleEvent",value:function(e){var t=this.prepareActionEvent(e);this.willBeInvokedByEvent(e)&&this.applyEventModifiers(t)&&this.invokeWithEvent(t)}},{key:"eventName",get:function(){return this.action.eventName}},{key:"method",get:function(){var e=this.controller[this.methodName];if(typeof e=="function")return e;throw new Error('Action "'.concat(this.action,'" references undefined method "').concat(this.methodName,'"'))}},{key:"applyEventModifiers",value:function(e){for(var t=this.action.element,i=this.context.application.actionDescriptorFilters,o=this.context.controller,a=!0,s=0,l=Object.entries(this.eventOptions);s<l.length;s++){var f=l[s],g=B(f,2),O=g[0],N=g[1];if(O in i){var M=i[O];a=a&&M({name:O,value:N,event:e,element:t,controller:o})}else continue}return a}},{key:"prepareActionEvent",value:function(e){return Object.assign(e,{params:this.action.params})}},{key:"invokeWithEvent",value:function(e){var t=e.target,i=e.currentTarget;try{this.method.call(this.controller,e),this.context.logDebugActivity(this.methodName,{event:e,target:t,currentTarget:i,action:this.methodName})}catch(g){var o=this.identifier,a=this.controller,s=this.element,l=this.index,f={identifier:o,controller:a,element:s,index:l,event:e};this.context.handleError(g,'invoking action "'.concat(this.action,'"'),f)}}},{key:"willBeInvokedByEvent",value:function(e){var t=e.target;return e instanceof KeyboardEvent&&this.action.shouldIgnoreKeyboardEvent(e)||e instanceof MouseEvent&&this.action.shouldIgnoreMouseEvent(e)?!1:this.element===t?!0:t instanceof Element&&this.element.contains(t)?this.scope.containsElement(t):this.scope.containsElement(this.action.element)}},{key:"controller",get:function(){return this.context.controller}},{key:"methodName",get:function(){return this.action.methodName}},{key:"element",get:function(){return this.scope.element}},{key:"scope",get:function(){return this.context.scope}}]),r}(),Oe=function(){function r(n,e){var t=this;y(this,r),this.mutationObserverInit={attributes:!0,childList:!0,subtree:!0},this.element=n,this.started=!1,this.delegate=e,this.elements=new Set,this.mutationObserver=new MutationObserver(function(i){return t.processMutations(i)})}return m(r,[{key:"start",value:function(){this.started||(this.started=!0,this.mutationObserver.observe(this.element,this.mutationObserverInit),this.refresh())}},{key:"pause",value:function(e){this.started&&(this.mutationObserver.disconnect(),this.started=!1),e(),this.started||(this.mutationObserver.observe(this.element,this.mutationObserverInit),this.started=!0)}},{key:"stop",value:function(){this.started&&(this.mutationObserver.takeRecords(),this.mutationObserver.disconnect(),this.started=!1)}},{key:"refresh",value:function(){if(this.started){for(var e=new Set(this.matchElementsInTree()),t=0,i=Array.from(this.elements);t<i.length;t++){var o=i[t];e.has(o)||this.removeElement(o)}for(var a=0,s=Array.from(e);a<s.length;a++){var l=s[a];this.addElement(l)}}}},{key:"processMutations",value:function(e){if(this.started){var t=w(e),i;try{for(t.s();!(i=t.n()).done;){var o=i.value;this.processMutation(o)}}catch(a){t.e(a)}finally{t.f()}}}},{key:"processMutation",value:function(e){e.type=="attributes"?this.processAttributeChange(e.target,e.attributeName):e.type=="childList"&&(this.processRemovedNodes(e.removedNodes),this.processAddedNodes(e.addedNodes))}},{key:"processAttributeChange",value:function(e,t){this.elements.has(e)?this.delegate.elementAttributeChanged&&this.matchElement(e)?this.delegate.elementAttributeChanged(e,t):this.removeElement(e):this.matchElement(e)&&this.addElement(e)}},{key:"processRemovedNodes",value:function(e){for(var t=0,i=Array.from(e);t<i.length;t++){var o=i[t],a=this.elementFromNode(o);a&&this.processTree(a,this.removeElement)}}},{key:"processAddedNodes",value:function(e){for(var t=0,i=Array.from(e);t<i.length;t++){var o=i[t],a=this.elementFromNode(o);a&&this.elementIsActive(a)&&this.processTree(a,this.addElement)}}},{key:"matchElement",value:function(e){return this.delegate.matchElement(e)}},{key:"matchElementsInTree",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.element;return this.delegate.matchElementsInTree(e)}},{key:"processTree",value:function(e,t){var i=w(this.matchElementsInTree(e)),o;try{for(i.s();!(o=i.n()).done;){var a=o.value;t.call(this,a)}}catch(s){i.e(s)}finally{i.f()}}},{key:"elementFromNode",value:function(e){if(e.nodeType==Node.ELEMENT_NODE)return e}},{key:"elementIsActive",value:function(e){return e.isConnected!=this.element.isConnected?!1:this.element.contains(e)}},{key:"addElement",value:function(e){this.elements.has(e)||this.elementIsActive(e)&&(this.elements.add(e),this.delegate.elementMatched&&this.delegate.elementMatched(e))}},{key:"removeElement",value:function(e){this.elements.has(e)&&(this.elements.delete(e),this.delegate.elementUnmatched&&this.delegate.elementUnmatched(e))}}]),r}(),Ee=function(){function r(n,e,t){y(this,r),this.attributeName=e,this.delegate=t,this.elementObserver=new Oe(n,this)}return m(r,[{key:"element",get:function(){return this.elementObserver.element}},{key:"selector",get:function(){return"[".concat(this.attributeName,"]")}},{key:"start",value:function(){this.elementObserver.start()}},{key:"pause",value:function(e){this.elementObserver.pause(e)}},{key:"stop",value:function(){this.elementObserver.stop()}},{key:"refresh",value:function(){this.elementObserver.refresh()}},{key:"started",get:function(){return this.elementObserver.started}},{key:"matchElement",value:function(e){return e.hasAttribute(this.attributeName)}},{key:"matchElementsInTree",value:function(e){var t=this.matchElement(e)?[e]:[],i=Array.from(e.querySelectorAll(this.selector));return t.concat(i)}},{key:"elementMatched",value:function(e){this.delegate.elementMatchedAttribute&&this.delegate.elementMatchedAttribute(e,this.attributeName)}},{key:"elementUnmatched",value:function(e){this.delegate.elementUnmatchedAttribute&&this.delegate.elementUnmatchedAttribute(e,this.attributeName)}},{key:"elementAttributeChanged",value:function(e,t){this.delegate.elementAttributeValueChanged&&this.attributeName==t&&this.delegate.elementAttributeValueChanged(e,t)}}]),r}();function tt(r,n,e){Ae(r,n).add(e)}function nt(r,n,e){Ae(r,n).delete(e),rt(r,n)}function Ae(r,n){var e=r.get(n);return e||(e=new Set,r.set(n,e)),e}function rt(r,n){var e=r.get(n);e!=null&&e.size==0&&r.delete(n)}var L=function(){function r(){y(this,r),this.valuesByKey=new Map}return m(r,[{key:"keys",get:function(){return Array.from(this.valuesByKey.keys())}},{key:"values",get:function(){var e=Array.from(this.valuesByKey.values());return e.reduce(function(t,i){return t.concat(Array.from(i))},[])}},{key:"size",get:function(){var e=Array.from(this.valuesByKey.values());return e.reduce(function(t,i){return t+i.size},0)}},{key:"add",value:function(e,t){tt(this.valuesByKey,e,t)}},{key:"delete",value:function(e,t){nt(this.valuesByKey,e,t)}},{key:"has",value:function(e,t){var i=this.valuesByKey.get(e);return i!=null&&i.has(t)}},{key:"hasKey",value:function(e){return this.valuesByKey.has(e)}},{key:"hasValue",value:function(e){var t=Array.from(this.valuesByKey.values());return t.some(function(i){return i.has(e)})}},{key:"getValuesForKey",value:function(e){var t=this.valuesByKey.get(e);return t?Array.from(t):[]}},{key:"getKeysForValue",value:function(e){return Array.from(this.valuesByKey).filter(function(t){var i=B(t,2);i[0];var o=i[1];return o.has(e)}).map(function(t){var i=B(t,2),o=i[0];return i[1],o})}}]),r}(),it=function(){function r(n,e,t,i){y(this,r),this._selector=e,this.details=i,this.elementObserver=new Oe(n,this),this.delegate=t,this.matchesByElement=new L}return m(r,[{key:"started",get:function(){return this.elementObserver.started}},{key:"selector",get:function(){return this._selector},set:function(e){this._selector=e,this.refresh()}},{key:"start",value:function(){this.elementObserver.start()}},{key:"pause",value:function(e){this.elementObserver.pause(e)}},{key:"stop",value:function(){this.elementObserver.stop()}},{key:"refresh",value:function(){this.elementObserver.refresh()}},{key:"element",get:function(){return this.elementObserver.element}},{key:"matchElement",value:function(e){var t=this.selector;if(t){var i=e.matches(t);return this.delegate.selectorMatchElement?i&&this.delegate.selectorMatchElement(e,this.details):i}else return!1}},{key:"matchElementsInTree",value:function(e){var t=this,i=this.selector;if(i){var o=this.matchElement(e)?[e]:[],a=Array.from(e.querySelectorAll(i)).filter(function(s){return t.matchElement(s)});return o.concat(a)}else return[]}},{key:"elementMatched",value:function(e){var t=this.selector;t&&this.selectorMatched(e,t)}},{key:"elementUnmatched",value:function(e){var t=this.matchesByElement.getKeysForValue(e),i=w(t),o;try{for(i.s();!(o=i.n()).done;){var a=o.value;this.selectorUnmatched(e,a)}}catch(s){i.e(s)}finally{i.f()}}},{key:"elementAttributeChanged",value:function(e,t){var i=this.selector;if(i){var o=this.matchElement(e),a=this.matchesByElement.has(i,e);o&&!a?this.selectorMatched(e,i):!o&&a&&this.selectorUnmatched(e,i)}}},{key:"selectorMatched",value:function(e,t){this.delegate.selectorMatched(e,t,this.details),this.matchesByElement.add(t,e)}},{key:"selectorUnmatched",value:function(e,t){this.delegate.selectorUnmatched(e,t,this.details),this.matchesByElement.delete(t,e)}}]),r}(),ot=function(){function r(n,e){var t=this;y(this,r),this.element=n,this.delegate=e,this.started=!1,this.stringMap=new Map,this.mutationObserver=new MutationObserver(function(i){return t.processMutations(i)})}return m(r,[{key:"start",value:function(){this.started||(this.started=!0,this.mutationObserver.observe(this.element,{attributes:!0,attributeOldValue:!0}),this.refresh())}},{key:"stop",value:function(){this.started&&(this.mutationObserver.takeRecords(),this.mutationObserver.disconnect(),this.started=!1)}},{key:"refresh",value:function(){if(this.started){var e=w(this.knownAttributeNames),t;try{for(e.s();!(t=e.n()).done;){var i=t.value;this.refreshAttribute(i,null)}}catch(o){e.e(o)}finally{e.f()}}}},{key:"processMutations",value:function(e){if(this.started){var t=w(e),i;try{for(t.s();!(i=t.n()).done;){var o=i.value;this.processMutation(o)}}catch(a){t.e(a)}finally{t.f()}}}},{key:"processMutation",value:function(e){var t=e.attributeName;t&&this.refreshAttribute(t,e.oldValue)}},{key:"refreshAttribute",value:function(e,t){var i=this.delegate.getStringMapKeyForAttribute(e);if(i!=null){this.stringMap.has(e)||this.stringMapKeyAdded(i,e);var o=this.element.getAttribute(e);if(this.stringMap.get(e)!=o&&this.stringMapValueChanged(o,i,t),o==null){var a=this.stringMap.get(e);this.stringMap.delete(e),a&&this.stringMapKeyRemoved(i,e,a)}else this.stringMap.set(e,o)}}},{key:"stringMapKeyAdded",value:function(e,t){this.delegate.stringMapKeyAdded&&this.delegate.stringMapKeyAdded(e,t)}},{key:"stringMapValueChanged",value:function(e,t,i){this.delegate.stringMapValueChanged&&this.delegate.stringMapValueChanged(e,t,i)}},{key:"stringMapKeyRemoved",value:function(e,t,i){this.delegate.stringMapKeyRemoved&&this.delegate.stringMapKeyRemoved(e,t,i)}},{key:"knownAttributeNames",get:function(){return Array.from(new Set(this.currentAttributeNames.concat(this.recordedAttributeNames)))}},{key:"currentAttributeNames",get:function(){return Array.from(this.element.attributes).map(function(e){return e.name})}},{key:"recordedAttributeNames",get:function(){return Array.from(this.stringMap.keys())}}]),r}(),we=function(){function r(n,e,t){y(this,r),this.attributeObserver=new Ee(n,e,this),this.delegate=t,this.tokensByElement=new L}return m(r,[{key:"started",get:function(){return this.attributeObserver.started}},{key:"start",value:function(){this.attributeObserver.start()}},{key:"pause",value:function(e){this.attributeObserver.pause(e)}},{key:"stop",value:function(){this.attributeObserver.stop()}},{key:"refresh",value:function(){this.attributeObserver.refresh()}},{key:"element",get:function(){return this.attributeObserver.element}},{key:"attributeName",get:function(){return this.attributeObserver.attributeName}},{key:"elementMatchedAttribute",value:function(e){this.tokensMatched(this.readTokensForElement(e))}},{key:"elementAttributeValueChanged",value:function(e){var t=this.refreshTokensForElement(e),i=B(t,2),o=i[0],a=i[1];this.tokensUnmatched(o),this.tokensMatched(a)}},{key:"elementUnmatchedAttribute",value:function(e){this.tokensUnmatched(this.tokensByElement.getValuesForKey(e))}},{key:"tokensMatched",value:function(e){var t=this;e.forEach(function(i){return t.tokenMatched(i)})}},{key:"tokensUnmatched",value:function(e){var t=this;e.forEach(function(i){return t.tokenUnmatched(i)})}},{key:"tokenMatched",value:function(e){this.delegate.tokenMatched(e),this.tokensByElement.add(e.element,e)}},{key:"tokenUnmatched",value:function(e){this.delegate.tokenUnmatched(e),this.tokensByElement.delete(e.element,e)}},{key:"refreshTokensForElement",value:function(e){var t=this.tokensByElement.getValuesForKey(e),i=this.readTokensForElement(e),o=st(t,i).findIndex(function(a){var s=B(a,2),l=s[0],f=s[1];return!ut(l,f)});return o==-1?[[],[]]:[t.slice(o),i.slice(o)]}},{key:"readTokensForElement",value:function(e){var t=this.attributeName,i=e.getAttribute(t)||"";return at(i,e,t)}}]),r}();function at(r,n,e){return r.trim().split(/\s+/).filter(function(t){return t.length}).map(function(t,i){return{element:n,attributeName:e,content:t,index:i}})}function st(r,n){var e=Math.max(r.length,n.length);return Array.from({length:e},function(t,i){return[r[i],n[i]]})}function ut(r,n){return r&&n&&r.index==n.index&&r.content==n.content}var Me=function(){function r(n,e,t){y(this,r),this.tokenListObserver=new we(n,e,this),this.delegate=t,this.parseResultsByToken=new WeakMap,this.valuesByTokenByElement=new WeakMap}return m(r,[{key:"started",get:function(){return this.tokenListObserver.started}},{key:"start",value:function(){this.tokenListObserver.start()}},{key:"stop",value:function(){this.tokenListObserver.stop()}},{key:"refresh",value:function(){this.tokenListObserver.refresh()}},{key:"element",get:function(){return this.tokenListObserver.element}},{key:"attributeName",get:function(){return this.tokenListObserver.attributeName}},{key:"tokenMatched",value:function(e){var t=e.element,i=this.fetchParseResultForToken(e),o=i.value;o&&(this.fetchValuesByTokenForElement(t).set(e,o),this.delegate.elementMatchedValue(t,o))}},{key:"tokenUnmatched",value:function(e){var t=e.element,i=this.fetchParseResultForToken(e),o=i.value;o&&(this.fetchValuesByTokenForElement(t).delete(e),this.delegate.elementUnmatchedValue(t,o))}},{key:"fetchParseResultForToken",value:function(e){var t=this.parseResultsByToken.get(e);return t||(t=this.parseToken(e),this.parseResultsByToken.set(e,t)),t}},{key:"fetchValuesByTokenForElement",value:function(e){var t=this.valuesByTokenByElement.get(e);return t||(t=new Map,this.valuesByTokenByElement.set(e,t)),t}},{key:"parseToken",value:function(e){try{var t=this.delegate.parseValueForToken(e);return{value:t}}catch(i){return{error:i}}}}]),r}(),ct=function(){function r(n,e){y(this,r),this.context=n,this.delegate=e,this.bindingsByAction=new Map}return m(r,[{key:"start",value:function(){this.valueListObserver||(this.valueListObserver=new Me(this.element,this.actionAttribute,this),this.valueListObserver.start())}},{key:"stop",value:function(){this.valueListObserver&&(this.valueListObserver.stop(),delete this.valueListObserver,this.disconnectAllActions())}},{key:"element",get:function(){return this.context.element}},{key:"identifier",get:function(){return this.context.identifier}},{key:"actionAttribute",get:function(){return this.schema.actionAttribute}},{key:"schema",get:function(){return this.context.schema}},{key:"bindings",get:function(){return Array.from(this.bindingsByAction.values())}},{key:"connectAction",value:function(e){var t=new et(this.context,e);this.bindingsByAction.set(e,t),this.delegate.bindingConnected(t)}},{key:"disconnectAction",value:function(e){var t=this.bindingsByAction.get(e);t&&(this.bindingsByAction.delete(e),this.delegate.bindingDisconnected(t))}},{key:"disconnectAllActions",value:function(){var e=this;this.bindings.forEach(function(t){return e.delegate.bindingDisconnected(t,!0)}),this.bindingsByAction.clear()}},{key:"parseValueForToken",value:function(e){var t=Ze.forToken(e,this.schema);if(t.identifier==this.identifier)return t}},{key:"elementMatchedValue",value:function(e,t){this.connectAction(t)}},{key:"elementUnmatchedValue",value:function(e,t){this.disconnectAction(t)}}]),r}(),lt=function(){function r(n,e){y(this,r),this.context=n,this.receiver=e,this.stringMapObserver=new ot(this.element,this),this.valueDescriptorMap=this.controller.valueDescriptorMap}return m(r,[{key:"start",value:function(){this.stringMapObserver.start(),this.invokeChangedCallbacksForDefaultValues()}},{key:"stop",value:function(){this.stringMapObserver.stop()}},{key:"element",get:function(){return this.context.element}},{key:"controller",get:function(){return this.context.controller}},{key:"getStringMapKeyForAttribute",value:function(e){if(e in this.valueDescriptorMap)return this.valueDescriptorMap[e].name}},{key:"stringMapKeyAdded",value:function(e,t){var i=this.valueDescriptorMap[t];this.hasValue(e)||this.invokeChangedCallback(e,i.writer(this.receiver[e]),i.writer(i.defaultValue))}},{key:"stringMapValueChanged",value:function(e,t,i){var o=this.valueDescriptorNameMap[t];e!==null&&(i===null&&(i=o.writer(o.defaultValue)),this.invokeChangedCallback(t,e,i))}},{key:"stringMapKeyRemoved",value:function(e,t,i){var o=this.valueDescriptorNameMap[e];this.hasValue(e)?this.invokeChangedCallback(e,o.writer(this.receiver[e]),i):this.invokeChangedCallback(e,o.writer(o.defaultValue),i)}},{key:"invokeChangedCallbacksForDefaultValues",value:function(){var e=w(this.valueDescriptors),t;try{for(e.s();!(t=e.n()).done;){var i=t.value,o=i.key,a=i.name,s=i.defaultValue,l=i.writer;s!=null&&!this.controller.data.has(o)&&this.invokeChangedCallback(a,l(s),void 0)}}catch(f){e.e(f)}finally{e.f()}}},{key:"invokeChangedCallback",value:function(e,t,i){var o="".concat(e,"Changed"),a=this.receiver[o];if(typeof a=="function"){var s=this.valueDescriptorNameMap[e];try{var l=s.reader(t),f=i;i&&(f=s.reader(i)),a.call(this.receiver,l,f)}catch(g){throw g instanceof TypeError&&(g.message='Stimulus Value "'.concat(this.context.identifier,".").concat(s.name,'" - ').concat(g.message)),g}}}},{key:"valueDescriptors",get:function(){var e=this.valueDescriptorMap;return Object.keys(e).map(function(t){return e[t]})}},{key:"valueDescriptorNameMap",get:function(){var e=this,t={};return Object.keys(this.valueDescriptorMap).forEach(function(i){var o=e.valueDescriptorMap[i];t[o.name]=o}),t}},{key:"hasValue",value:function(e){var t=this.valueDescriptorNameMap[e],i="has".concat(K(t.name));return this.receiver[i]}}]),r}(),ht=function(){function r(n,e){y(this,r),this.context=n,this.delegate=e,this.targetsByName=new L}return m(r,[{key:"start",value:function(){this.tokenListObserver||(this.tokenListObserver=new we(this.element,this.attributeName,this),this.tokenListObserver.start())}},{key:"stop",value:function(){this.tokenListObserver&&(this.disconnectAllTargets(),this.tokenListObserver.stop(),delete this.tokenListObserver)}},{key:"tokenMatched",value:function(e){var t=e.element,i=e.content;this.scope.containsElement(t)&&this.connectTarget(t,i)}},{key:"tokenUnmatched",value:function(e){var t=e.element,i=e.content;this.disconnectTarget(t,i)}},{key:"connectTarget",value:function(e,t){var i=this,o;this.targetsByName.has(t,e)||(this.targetsByName.add(t,e),(o=this.tokenListObserver)===null||o===void 0||o.pause(function(){return i.delegate.targetConnected(e,t)}))}},{key:"disconnectTarget",value:function(e,t){var i=this,o;this.targetsByName.has(t,e)&&(this.targetsByName.delete(t,e),(o=this.tokenListObserver)===null||o===void 0||o.pause(function(){return i.delegate.targetDisconnected(e,t)}))}},{key:"disconnectAllTargets",value:function(){var e=w(this.targetsByName.keys),t;try{for(e.s();!(t=e.n()).done;){var i=t.value,o=w(this.targetsByName.getValuesForKey(i)),a;try{for(o.s();!(a=o.n()).done;){var s=a.value;this.disconnectTarget(s,i)}}catch(l){o.e(l)}finally{o.f()}}}catch(l){e.e(l)}finally{e.f()}}},{key:"attributeName",get:function(){return"data-".concat(this.context.identifier,"-target")}},{key:"element",get:function(){return this.context.element}},{key:"scope",get:function(){return this.context.scope}}]),r}();function _(r,n){var e=Fe(r);return Array.from(e.reduce(function(t,i){return dt(i,n).forEach(function(o){return t.add(o)}),t},new Set))}function ft(r,n){var e=Fe(r);return e.reduce(function(t,i){return t.push.apply(t,C(vt(i,n))),t},[])}function Fe(r){for(var n=[];r;)n.push(r),r=Object.getPrototypeOf(r);return n.reverse()}function dt(r,n){var e=r[n];return Array.isArray(e)?e:[]}function vt(r,n){var e=r[n];return e?Object.keys(e).map(function(t){return[t,e[t]]}):[]}var gt=function(){function r(n,e){y(this,r),this.started=!1,this.context=n,this.delegate=e,this.outletsByName=new L,this.outletElementsByName=new L,this.selectorObserverMap=new Map,this.attributeObserverMap=new Map}return m(r,[{key:"start",value:function(){var e=this;this.started||(this.outletDefinitions.forEach(function(t){e.setupSelectorObserverForOutlet(t),e.setupAttributeObserverForOutlet(t)}),this.started=!0,this.dependentContexts.forEach(function(t){return t.refresh()}))}},{key:"refresh",value:function(){this.selectorObserverMap.forEach(function(e){return e.refresh()}),this.attributeObserverMap.forEach(function(e){return e.refresh()})}},{key:"stop",value:function(){this.started&&(this.started=!1,this.disconnectAllOutlets(),this.stopSelectorObservers(),this.stopAttributeObservers())}},{key:"stopSelectorObservers",value:function(){this.selectorObserverMap.size>0&&(this.selectorObserverMap.forEach(function(e){return e.stop()}),this.selectorObserverMap.clear())}},{key:"stopAttributeObservers",value:function(){this.attributeObserverMap.size>0&&(this.attributeObserverMap.forEach(function(e){return e.stop()}),this.attributeObserverMap.clear())}},{key:"selectorMatched",value:function(e,t,i){var o=i.outletName,a=this.getOutlet(e,o);a&&this.connectOutlet(a,e,o)}},{key:"selectorUnmatched",value:function(e,t,i){var o=i.outletName,a=this.getOutletFromMap(e,o);a&&this.disconnectOutlet(a,e,o)}},{key:"selectorMatchElement",value:function(e,t){var i=t.outletName,o=this.selector(i),a=this.hasOutlet(e,i),s=e.matches("[".concat(this.schema.controllerAttribute,"~=").concat(i,"]"));return o?a&&s&&e.matches(o):!1}},{key:"elementMatchedAttribute",value:function(e,t){var i=this.getOutletNameFromOutletAttributeName(t);i&&this.updateSelectorObserverForOutlet(i)}},{key:"elementAttributeValueChanged",value:function(e,t){var i=this.getOutletNameFromOutletAttributeName(t);i&&this.updateSelectorObserverForOutlet(i)}},{key:"elementUnmatchedAttribute",value:function(e,t){var i=this.getOutletNameFromOutletAttributeName(t);i&&this.updateSelectorObserverForOutlet(i)}},{key:"connectOutlet",value:function(e,t,i){var o=this,a;this.outletElementsByName.has(i,t)||(this.outletsByName.add(i,e),this.outletElementsByName.add(i,t),(a=this.selectorObserverMap.get(i))===null||a===void 0||a.pause(function(){return o.delegate.outletConnected(e,t,i)}))}},{key:"disconnectOutlet",value:function(e,t,i){var o=this,a;this.outletElementsByName.has(i,t)&&(this.outletsByName.delete(i,e),this.outletElementsByName.delete(i,t),(a=this.selectorObserverMap.get(i))===null||a===void 0||a.pause(function(){return o.delegate.outletDisconnected(e,t,i)}))}},{key:"disconnectAllOutlets",value:function(){var e=w(this.outletElementsByName.keys),t;try{for(e.s();!(t=e.n()).done;){var i=t.value,o=w(this.outletElementsByName.getValuesForKey(i)),a;try{for(o.s();!(a=o.n()).done;){var s=a.value,l=w(this.outletsByName.getValuesForKey(i)),f;try{for(l.s();!(f=l.n()).done;){var g=f.value;this.disconnectOutlet(g,s,i)}}catch(O){l.e(O)}finally{l.f()}}}catch(O){o.e(O)}finally{o.f()}}}catch(O){e.e(O)}finally{e.f()}}},{key:"updateSelectorObserverForOutlet",value:function(e){var t=this.selectorObserverMap.get(e);t&&(t.selector=this.selector(e))}},{key:"setupSelectorObserverForOutlet",value:function(e){var t=this.selector(e),i=new it(document.body,t,this,{outletName:e});this.selectorObserverMap.set(e,i),i.start()}},{key:"setupAttributeObserverForOutlet",value:function(e){var t=this.attributeNameForOutletName(e),i=new Ee(this.scope.element,t,this);this.attributeObserverMap.set(e,i),i.start()}},{key:"selector",value:function(e){return this.scope.outlets.getSelectorForOutletName(e)}},{key:"attributeNameForOutletName",value:function(e){return this.scope.schema.outletAttributeForScope(this.identifier,e)}},{key:"getOutletNameFromOutletAttributeName",value:function(e){var t=this;return this.outletDefinitions.find(function(i){return t.attributeNameForOutletName(i)===e})}},{key:"outletDependencies",get:function(){var e=new L;return this.router.modules.forEach(function(t){var i=t.definition.controllerConstructor,o=_(i,"outlets");o.forEach(function(a){return e.add(a,t.identifier)})}),e}},{key:"outletDefinitions",get:function(){return this.outletDependencies.getKeysForValue(this.identifier)}},{key:"dependentControllerIdentifiers",get:function(){return this.outletDependencies.getValuesForKey(this.identifier)}},{key:"dependentContexts",get:function(){var e=this.dependentControllerIdentifiers;return this.router.contexts.filter(function(t){return e.includes(t.identifier)})}},{key:"hasOutlet",value:function(e,t){return!!this.getOutlet(e,t)||!!this.getOutletFromMap(e,t)}},{key:"getOutlet",value:function(e,t){return this.application.getControllerForElementAndIdentifier(e,t)}},{key:"getOutletFromMap",value:function(e,t){return this.outletsByName.getValuesForKey(t).find(function(i){return i.element===e})}},{key:"scope",get:function(){return this.context.scope}},{key:"schema",get:function(){return this.context.schema}},{key:"identifier",get:function(){return this.context.identifier}},{key:"application",get:function(){return this.context.application}},{key:"router",get:function(){return this.application.router}}]),r}(),pt=function(){function r(n,e){var t=this;y(this,r),this.logDebugActivity=function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=t.identifier,s=t.controller,l=t.element;o=Object.assign({identifier:a,controller:s,element:l},o),t.application.logDebugActivity(t.identifier,i,o)},this.module=n,this.scope=e,this.controller=new n.controllerConstructor(this),this.bindingObserver=new ct(this,this.dispatcher),this.valueObserver=new lt(this,this.controller),this.targetObserver=new ht(this,this),this.outletObserver=new gt(this,this);try{this.controller.initialize(),this.logDebugActivity("initialize")}catch(i){this.handleError(i,"initializing controller")}}return m(r,[{key:"connect",value:function(){this.bindingObserver.start(),this.valueObserver.start(),this.targetObserver.start(),this.outletObserver.start();try{this.controller.connect(),this.logDebugActivity("connect")}catch(e){this.handleError(e,"connecting controller")}}},{key:"refresh",value:function(){this.outletObserver.refresh()}},{key:"disconnect",value:function(){try{this.controller.disconnect(),this.logDebugActivity("disconnect")}catch(e){this.handleError(e,"disconnecting controller")}this.outletObserver.stop(),this.targetObserver.stop(),this.valueObserver.stop(),this.bindingObserver.stop()}},{key:"application",get:function(){return this.module.application}},{key:"identifier",get:function(){return this.module.identifier}},{key:"schema",get:function(){return this.application.schema}},{key:"dispatcher",get:function(){return this.application.dispatcher}},{key:"element",get:function(){return this.scope.element}},{key:"parentElement",get:function(){return this.element.parentElement}},{key:"handleError",value:function(e,t){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},o=this.identifier,a=this.controller,s=this.element;i=Object.assign({identifier:o,controller:a,element:s},i),this.application.handleError(e,"Error ".concat(t),i)}},{key:"targetConnected",value:function(e,t){this.invokeControllerMethod("".concat(t,"TargetConnected"),e)}},{key:"targetDisconnected",value:function(e,t){this.invokeControllerMethod("".concat(t,"TargetDisconnected"),e)}},{key:"outletConnected",value:function(e,t,i){this.invokeControllerMethod("".concat(X(i),"OutletConnected"),e,t)}},{key:"outletDisconnected",value:function(e,t,i){this.invokeControllerMethod("".concat(X(i),"OutletDisconnected"),e,t)}},{key:"invokeControllerMethod",value:function(e){var t=this.controller;if(typeof t[e]=="function"){for(var i=arguments.length,o=new Array(i>1?i-1:0),a=1;a<i;a++)o[a-1]=arguments[a];t[e].apply(t,o)}}}]),r}();function yt(r){return mt(r,bt(r))}function mt(r,n){var e=At(r),t=kt(r.prototype,n);return Object.defineProperties(e.prototype,t),e}function bt(r){var n=_(r,"blessings");return n.reduce(function(e,t){var i=t(r);for(var o in i){var a=e[o]||{};e[o]=Object.assign(a,i[o])}return e},{})}function kt(r,n){return Et(n).reduce(function(e,t){var i=Ot(r,n,t);return i&&Object.assign(e,E({},t,i)),e},{})}function Ot(r,n,e){var t=Object.getOwnPropertyDescriptor(r,e),i=t&&"value"in t;if(!i){var o=Object.getOwnPropertyDescriptor(n,e).value;return t&&(o.get=t.get||o.get,o.set=t.set||o.set),o}}var Et=function(){return typeof Object.getOwnPropertySymbols=="function"?function(r){return[].concat(C(Object.getOwnPropertyNames(r)),C(Object.getOwnPropertySymbols(r)))}:Object.getOwnPropertyNames}(),At=function(){function r(e){function t(){return Reflect.construct(e,arguments,this instanceof t?this.constructor:void 0)}return t.prototype=Object.create(e.prototype,{constructor:{value:t}}),Reflect.setPrototypeOf(t,e),t}function n(){var e=function(){this.a.call(this)},t=r(e);return t.prototype.a=function(){},new t}try{return n(),r}catch{return function(t){return function(i){De(a,i);var o=Ie(a);function a(){return y(this,a),o.apply(this,arguments)}return m(a)}(t)}}}();function wt(r){return{identifier:r.identifier,controllerConstructor:yt(r.controllerConstructor)}}var Mt=function(){function r(n,e){y(this,r),this.application=n,this.definition=wt(e),this.contextsByScope=new WeakMap,this.connectedContexts=new Set}return m(r,[{key:"identifier",get:function(){return this.definition.identifier}},{key:"controllerConstructor",get:function(){return this.definition.controllerConstructor}},{key:"contexts",get:function(){return Array.from(this.connectedContexts)}},{key:"connectContextForScope",value:function(e){var t=this.fetchContextForScope(e);this.connectedContexts.add(t),t.connect()}},{key:"disconnectContextForScope",value:function(e){var t=this.contextsByScope.get(e);t&&(this.connectedContexts.delete(t),t.disconnect())}},{key:"fetchContextForScope",value:function(e){var t=this.contextsByScope.get(e);return t||(t=new pt(this,e),this.contextsByScope.set(e,t)),t}}]),r}(),Ft=function(){function r(n){y(this,r),this.scope=n}return m(r,[{key:"has",value:function(e){return this.data.has(this.getDataKey(e))}},{key:"get",value:function(e){return this.getAll(e)[0]}},{key:"getAll",value:function(e){var t=this.data.get(this.getDataKey(e))||"";return Ye(t)}},{key:"getAttributeName",value:function(e){return this.data.getAttributeNameForKey(this.getDataKey(e))}},{key:"getDataKey",value:function(e){return"".concat(e,"-class")}},{key:"data",get:function(){return this.scope.data}}]),r}(),Tt=function(){function r(n){y(this,r),this.scope=n}return m(r,[{key:"element",get:function(){return this.scope.element}},{key:"identifier",get:function(){return this.scope.identifier}},{key:"get",value:function(e){var t=this.getAttributeNameForKey(e);return this.element.getAttribute(t)}},{key:"set",value:function(e,t){var i=this.getAttributeNameForKey(e);return this.element.setAttribute(i,t),this.get(e)}},{key:"has",value:function(e){var t=this.getAttributeNameForKey(e);return this.element.hasAttribute(t)}},{key:"delete",value:function(e){if(this.has(e)){var t=this.getAttributeNameForKey(e);return this.element.removeAttribute(t),!0}else return!1}},{key:"getAttributeNameForKey",value:function(e){return"data-".concat(this.identifier,"-").concat(ke(e))}}]),r}(),St=function(){function r(n){y(this,r),this.warnedKeysByObject=new WeakMap,this.logger=n}return m(r,[{key:"warn",value:function(e,t,i){var o=this.warnedKeysByObject.get(e);o||(o=new Set,this.warnedKeysByObject.set(e,o)),o.has(t)||(o.add(t),this.logger.warn(i,e))}}]),r}();function te(r,n){return"[".concat(r,'~="').concat(n,'"]')}var Ct=function(){function r(n){y(this,r),this.scope=n}return m(r,[{key:"element",get:function(){return this.scope.element}},{key:"identifier",get:function(){return this.scope.identifier}},{key:"schema",get:function(){return this.scope.schema}},{key:"has",value:function(e){return this.find(e)!=null}},{key:"find",value:function(){for(var e=this,t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return i.reduce(function(a,s){return a||e.findTarget(s)||e.findLegacyTarget(s)},void 0)}},{key:"findAll",value:function(){for(var e=this,t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return i.reduce(function(a,s){return[].concat(C(a),C(e.findAllTargets(s)),C(e.findAllLegacyTargets(s)))},[])}},{key:"findTarget",value:function(e){var t=this.getSelectorForTargetName(e);return this.scope.findElement(t)}},{key:"findAllTargets",value:function(e){var t=this.getSelectorForTargetName(e);return this.scope.findAllElements(t)}},{key:"getSelectorForTargetName",value:function(e){var t=this.schema.targetAttributeForScope(this.identifier);return te(t,e)}},{key:"findLegacyTarget",value:function(e){var t=this.getLegacySelectorForTargetName(e);return this.deprecate(this.scope.findElement(t),e)}},{key:"findAllLegacyTargets",value:function(e){var t=this,i=this.getLegacySelectorForTargetName(e);return this.scope.findAllElements(i).map(function(o){return t.deprecate(o,e)})}},{key:"getLegacySelectorForTargetName",value:function(e){var t="".concat(this.identifier,".").concat(e);return te(this.schema.targetAttribute,t)}},{key:"deprecate",value:function(e,t){if(e){var i=this.identifier,o=this.schema.targetAttribute,a=this.schema.targetAttributeForScope(i);this.guide.warn(e,"target:".concat(t),"Please replace ".concat(o,'="').concat(i,".").concat(t,'" with ').concat(a,'="').concat(t,'". ')+"The ".concat(o," attribute is deprecated and will be removed in a future version of Stimulus."))}return e}},{key:"guide",get:function(){return this.scope.guide}}]),r}(),Nt=function(){function r(n,e){y(this,r),this.scope=n,this.controllerElement=e}return m(r,[{key:"element",get:function(){return this.scope.element}},{key:"identifier",get:function(){return this.scope.identifier}},{key:"schema",get:function(){return this.scope.schema}},{key:"has",value:function(e){return this.find(e)!=null}},{key:"find",value:function(){for(var e=this,t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return i.reduce(function(a,s){return a||e.findOutlet(s)},void 0)}},{key:"findAll",value:function(){for(var e=this,t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return i.reduce(function(a,s){return[].concat(C(a),C(e.findAllOutlets(s)))},[])}},{key:"getSelectorForOutletName",value:function(e){var t=this.schema.outletAttributeForScope(this.identifier,e);return this.controllerElement.getAttribute(t)}},{key:"findOutlet",value:function(e){var t=this.getSelectorForOutletName(e);if(t)return this.findElement(t,e)}},{key:"findAllOutlets",value:function(e){var t=this.getSelectorForOutletName(e);return t?this.findAllElements(t,e):[]}},{key:"findElement",value:function(e,t){var i=this,o=this.scope.queryElements(e);return o.filter(function(a){return i.matchesElement(a,e,t)})[0]}},{key:"findAllElements",value:function(e,t){var i=this,o=this.scope.queryElements(e);return o.filter(function(a){return i.matchesElement(a,e,t)})}},{key:"matchesElement",value:function(e,t,i){var o=e.getAttribute(this.scope.schema.controllerAttribute)||"";return e.matches(t)&&o.split(" ").includes(i)}}]),r}(),Bt=function(){function r(n,e,t,i){var o=this;y(this,r),this.targets=new Ct(this),this.classes=new Ft(this),this.data=new Tt(this),this.containsElement=function(a){return a.closest(o.controllerSelector)===o.element},this.schema=n,this.element=e,this.identifier=t,this.guide=new St(i),this.outlets=new Nt(this.documentScope,e)}return m(r,[{key:"findElement",value:function(e){return this.element.matches(e)?this.element:this.queryElements(e).find(this.containsElement)}},{key:"findAllElements",value:function(e){return[].concat(C(this.element.matches(e)?[this.element]:[]),C(this.queryElements(e).filter(this.containsElement)))}},{key:"queryElements",value:function(e){return Array.from(this.element.querySelectorAll(e))}},{key:"controllerSelector",get:function(){return te(this.schema.controllerAttribute,this.identifier)}},{key:"isDocumentScope",get:function(){return this.element===document.documentElement}},{key:"documentScope",get:function(){return this.isDocumentScope?this:new r(this.schema,document.documentElement,this.identifier,this.guide.logger)}}]),r}(),Lt=function(){function r(n,e,t){y(this,r),this.element=n,this.schema=e,this.delegate=t,this.valueListObserver=new Me(this.element,this.controllerAttribute,this),this.scopesByIdentifierByElement=new WeakMap,this.scopeReferenceCounts=new WeakMap}return m(r,[{key:"start",value:function(){this.valueListObserver.start()}},{key:"stop",value:function(){this.valueListObserver.stop()}},{key:"controllerAttribute",get:function(){return this.schema.controllerAttribute}},{key:"parseValueForToken",value:function(e){var t=e.element,i=e.content;return this.parseValueForElementAndIdentifier(t,i)}},{key:"parseValueForElementAndIdentifier",value:function(e,t){var i=this.fetchScopesByIdentifierForElement(e),o=i.get(t);return o||(o=this.delegate.createScopeForElementAndIdentifier(e,t),i.set(t,o)),o}},{key:"elementMatchedValue",value:function(e,t){var i=(this.scopeReferenceCounts.get(t)||0)+1;this.scopeReferenceCounts.set(t,i),i==1&&this.delegate.scopeConnected(t)}},{key:"elementUnmatchedValue",value:function(e,t){var i=this.scopeReferenceCounts.get(t);i&&(this.scopeReferenceCounts.set(t,i-1),i==1&&this.delegate.scopeDisconnected(t))}},{key:"fetchScopesByIdentifierForElement",value:function(e){var t=this.scopesByIdentifierByElement.get(e);return t||(t=new Map,this.scopesByIdentifierByElement.set(e,t)),t}}]),r}(),Dt=function(){function r(n){y(this,r),this.application=n,this.scopeObserver=new Lt(this.element,this.schema,this),this.scopesByIdentifier=new L,this.modulesByIdentifier=new Map}return m(r,[{key:"element",get:function(){return this.application.element}},{key:"schema",get:function(){return this.application.schema}},{key:"logger",get:function(){return this.application.logger}},{key:"controllerAttribute",get:function(){return this.schema.controllerAttribute}},{key:"modules",get:function(){return Array.from(this.modulesByIdentifier.values())}},{key:"contexts",get:function(){return this.modules.reduce(function(e,t){return e.concat(t.contexts)},[])}},{key:"start",value:function(){this.scopeObserver.start()}},{key:"stop",value:function(){this.scopeObserver.stop()}},{key:"loadDefinition",value:function(e){this.unloadIdentifier(e.identifier);var t=new Mt(this.application,e);this.connectModule(t);var i=e.controllerConstructor.afterLoad;i&&i.call(e.controllerConstructor,e.identifier,this.application)}},{key:"unloadIdentifier",value:function(e){var t=this.modulesByIdentifier.get(e);t&&this.disconnectModule(t)}},{key:"getContextForElementAndIdentifier",value:function(e,t){var i=this.modulesByIdentifier.get(t);if(i)return i.contexts.find(function(o){return o.element==e})}},{key:"proposeToConnectScopeForElementAndIdentifier",value:function(e,t){var i=this.scopeObserver.parseValueForElementAndIdentifier(e,t);i?this.scopeObserver.elementMatchedValue(i.element,i):console.error(`Couldn't find or create scope for identifier: "`.concat(t,'" and element:'),e)}},{key:"handleError",value:function(e,t,i){this.application.handleError(e,t,i)}},{key:"createScopeForElementAndIdentifier",value:function(e,t){return new Bt(this.schema,e,t,this.logger)}},{key:"scopeConnected",value:function(e){this.scopesByIdentifier.add(e.identifier,e);var t=this.modulesByIdentifier.get(e.identifier);t&&t.connectContextForScope(e)}},{key:"scopeDisconnected",value:function(e){this.scopesByIdentifier.delete(e.identifier,e);var t=this.modulesByIdentifier.get(e.identifier);t&&t.disconnectContextForScope(e)}},{key:"connectModule",value:function(e){this.modulesByIdentifier.set(e.identifier,e);var t=this.scopesByIdentifier.getValuesForKey(e.identifier);t.forEach(function(i){return e.connectContextForScope(i)})}},{key:"disconnectModule",value:function(e){this.modulesByIdentifier.delete(e.identifier);var t=this.scopesByIdentifier.getValuesForKey(e.identifier);t.forEach(function(i){return e.disconnectContextForScope(i)})}}]),r}(),It={controllerAttribute:"data-controller",actionAttribute:"data-action",targetAttribute:"data-target",targetAttributeForScope:function(n){return"data-".concat(n,"-target")},outletAttributeForScope:function(n,e){return"data-".concat(n,"-").concat(e,"-outlet")},keyMappings:Object.assign(Object.assign({enter:"Enter",tab:"Tab",esc:"Escape",space:" ",up:"ArrowUp",down:"ArrowDown",left:"ArrowLeft",right:"ArrowRight",home:"Home",end:"End",page_up:"PageUp",page_down:"PageDown"},ve("abcdefghijklmnopqrstuvwxyz".split("").map(function(r){return[r,r]}))),ve("0123456789".split("").map(function(r){return[r,r]})))};function ve(r){return r.reduce(function(n,e){var t=B(e,2),i=t[0],o=t[1];return Object.assign(Object.assign({},n),E({},i,o))},{})}var Yt=function(){function r(){var n=this,e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document.documentElement,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:It;y(this,r),this.logger=console,this.debug=!1,this.logDebugActivity=function(i,o){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};n.debug&&n.logFormattedMessage(i,o,a)},this.element=e,this.schema=t,this.dispatcher=new ze(this),this.router=new Dt(this),this.actionDescriptorFilters=Object.assign({},Ge)}return m(r,[{key:"start",value:function(){var n=Ce(Y().mark(function t(){return Y().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,xt();case 2:this.logDebugActivity("application","starting"),this.dispatcher.start(),this.router.start(),this.logDebugActivity("application","start");case 6:case"end":return o.stop()}},t,this)}));function e(){return n.apply(this,arguments)}return e}()},{key:"stop",value:function(){this.logDebugActivity("application","stopping"),this.dispatcher.stop(),this.router.stop(),this.logDebugActivity("application","stop")}},{key:"register",value:function(e,t){this.load({identifier:e,controllerConstructor:t})}},{key:"registerActionOption",value:function(e,t){this.actionDescriptorFilters[e]=t}},{key:"load",value:function(e){for(var t=this,i=arguments.length,o=new Array(i>1?i-1:0),a=1;a<i;a++)o[a-1]=arguments[a];var s=Array.isArray(e)?e:[e].concat(o);s.forEach(function(l){l.controllerConstructor.shouldLoad&&t.router.loadDefinition(l)})}},{key:"unload",value:function(e){for(var t=this,i=arguments.length,o=new Array(i>1?i-1:0),a=1;a<i;a++)o[a-1]=arguments[a];var s=Array.isArray(e)?e:[e].concat(o);s.forEach(function(l){return t.router.unloadIdentifier(l)})}},{key:"controllers",get:function(){return this.router.contexts.map(function(e){return e.controller})}},{key:"getControllerForElementAndIdentifier",value:function(e,t){var i=this.router.getContextForElementAndIdentifier(e,t);return i?i.controller:null}},{key:"handleError",value:function(e,t,i){var o;this.logger.error(`%s

%o

%o`,t,e,i),(o=window.onerror)===null||o===void 0||o.call(window,t,"",0,0,e)}},{key:"logFormattedMessage",value:function(e,t){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};i=Object.assign({application:this},i),this.logger.groupCollapsed("".concat(e," #").concat(t)),this.logger.log("details:",Object.assign({},i)),this.logger.groupEnd()}}],[{key:"start",value:function(e,t){var i=new this(e,t);return i.start(),i}}]),r}();function xt(){return new Promise(function(r){document.readyState=="loading"?document.addEventListener("DOMContentLoaded",function(){return r()}):r()})}function Vt(r){var n=_(r,"classes");return n.reduce(function(e,t){return Object.assign(e,jt(t))},{})}function jt(r){var n;return n={},E(n,"".concat(r,"Class"),{get:function(){var t=this.classes;if(t.has(r))return t.get(r);var i=t.getAttributeName(r);throw new Error('Missing attribute "'.concat(i,'"'))}}),E(n,"".concat(r,"Classes"),{get:function(){return this.classes.getAll(r)}}),E(n,"has".concat(K(r),"Class"),{get:function(){return this.classes.has(r)}}),n}function Kt(r){var n=_(r,"outlets");return n.reduce(function(e,t){return Object.assign(e,_t(t))},{})}function ge(r,n,e){return r.application.getControllerForElementAndIdentifier(n,e)}function pe(r,n,e){var t=ge(r,n,e);if(t||(r.application.router.proposeToConnectScopeForElementAndIdentifier(n,e),t=ge(r,n,e),t))return t}function _t(r){var n,e=X(r);return n={},E(n,"".concat(e,"Outlet"),{get:function(){var i=this.outlets.find(r),o=this.outlets.getSelectorForOutletName(r);if(i){var a=pe(this,i,r);if(a)return a;throw new Error('The provided outlet element is missing an outlet controller "'.concat(r,'" instance for host controller "').concat(this.identifier,'"'))}throw new Error('Missing outlet element "'.concat(r,'" for host controller "').concat(this.identifier,`". Stimulus couldn't find a matching outlet element using selector "`).concat(o,'".'))}}),E(n,"".concat(e,"Outlets"),{get:function(){var i=this,o=this.outlets.findAll(r);return o.length>0?o.map(function(a){var s=pe(i,a,r);if(s)return s;console.warn('The provided outlet element is missing an outlet controller "'.concat(r,'" instance for host controller "').concat(i.identifier,'"'),a)}).filter(function(a){return a}):[]}}),E(n,"".concat(e,"OutletElement"),{get:function(){var i=this.outlets.find(r),o=this.outlets.getSelectorForOutletName(r);if(i)return i;throw new Error('Missing outlet element "'.concat(r,'" for host controller "').concat(this.identifier,`". Stimulus couldn't find a matching outlet element using selector "`).concat(o,'".'))}}),E(n,"".concat(e,"OutletElements"),{get:function(){return this.outlets.findAll(r)}}),E(n,"has".concat(K(e),"Outlet"),{get:function(){return this.outlets.has(r)}}),n}function Pt(r){var n=_(r,"targets");return n.reduce(function(e,t){return Object.assign(e,Rt(t))},{})}function Rt(r){var n;return n={},E(n,"".concat(r,"Target"),{get:function(){var t=this.targets.find(r);if(t)return t;throw new Error('Missing target element "'.concat(r,'" for "').concat(this.identifier,'" controller'))}}),E(n,"".concat(r,"Targets"),{get:function(){return this.targets.findAll(r)}}),E(n,"has".concat(K(r),"Target"),{get:function(){return this.targets.has(r)}}),n}function Ut(r){var n=ft(r,"values"),e={valueDescriptorMap:{get:function(){var i=this;return n.reduce(function(o,a){var s=Te(a,i.identifier),l=i.data.getAttributeNameForKey(s.key);return Object.assign(o,E({},l,s))},{})}}};return n.reduce(function(t,i){return Object.assign(t,zt(i))},e)}function zt(r,n){var e,t=Te(r,n),i=t.key,o=t.name,a=t.reader,s=t.writer;return e={},E(e,o,{get:function(){var f=this.data.get(i);return f!==null?a(f):t.defaultValue},set:function(f){f===void 0?this.data.delete(i):this.data.set(i,s(f))}}),E(e,"has".concat(K(o)),{get:function(){return this.data.has(i)||t.hasCustomDefaultValue}}),e}function Te(r,n){var e=B(r,2),t=e[0],i=e[1];return $t({controller:n,token:t,typeDefinition:i})}function G(r){switch(r){case Array:return"array";case Boolean:return"boolean";case Number:return"number";case Object:return"object";case String:return"string"}}function j(r){switch(typeof r){case"boolean":return"boolean";case"number":return"number";case"string":return"string"}if(Array.isArray(r))return"array";if(Object.prototype.toString.call(r)==="[object Object]")return"object"}function Gt(r){var n=r.controller,e=r.token,t=r.typeObject,i=he(t.type),o=he(t.default),a=i&&o,s=i&&!o,l=!i&&o,f=G(t.type),g=j(r.typeObject.default);if(s)return f;if(l)return g;if(f!==g){var O=n?"".concat(n,".").concat(e):e;throw new Error('The specified default value for the Stimulus Value "'.concat(O,'" must match the defined type "').concat(f,'". The provided default value of "').concat(t.default,'" is of type "').concat(g,'".'))}if(a)return f}function Wt(r){var n=r.controller,e=r.token,t=r.typeDefinition,i={controller:n,token:e,typeObject:t},o=Gt(i),a=j(t),s=G(t),l=o||a||s;if(l)return l;var f=n?"".concat(n,".").concat(t):e;throw new Error('Unknown value type "'.concat(f,'" for "').concat(e,'" value'))}function qt(r){var n=G(r);if(n)return ye[n];var e=ee(r,"default"),t=ee(r,"type"),i=r;if(e)return i.default;if(t){var o=i.type,a=G(o);if(a)return ye[a]}return r}function $t(r){var n=r.token,e=r.typeDefinition,t="".concat(ke(n),"-value"),i=Wt(r);return{type:i,key:t,name:re(t),get defaultValue(){return qt(e)},get hasCustomDefaultValue(){return j(e)!==void 0},reader:Jt[i],writer:me[i]||me.default}}var ye={get array(){return[]},boolean:!1,number:0,get object(){return{}},string:""},Jt={array:function(n){var e=JSON.parse(n);if(!Array.isArray(e))throw new TypeError('expected value of type "array" but instead got value "'.concat(n,'" of type "').concat(j(e),'"'));return e},boolean:function(n){return!(n=="0"||String(n).toLowerCase()=="false")},number:function(n){return Number(n.replace(/_/g,""))},object:function(n){var e=JSON.parse(n);if(e===null||typeof e!="object"||Array.isArray(e))throw new TypeError('expected value of type "object" but instead got value "'.concat(n,'" of type "').concat(j(e),'"'));return e},string:function(n){return n}},me={default:Ht,array:be,object:be};function be(r){return JSON.stringify(r)}function Ht(r){return"".concat(r)}var W=function(){function r(n){y(this,r),this.context=n}return m(r,[{key:"application",get:function(){return this.context.application}},{key:"scope",get:function(){return this.context.scope}},{key:"element",get:function(){return this.scope.element}},{key:"identifier",get:function(){return this.scope.identifier}},{key:"targets",get:function(){return this.scope.targets}},{key:"outlets",get:function(){return this.scope.outlets}},{key:"classes",get:function(){return this.scope.classes}},{key:"data",get:function(){return this.scope.data}},{key:"initialize",value:function(){}},{key:"connect",value:function(){}},{key:"disconnect",value:function(){}},{key:"dispatch",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=t.target,o=i===void 0?this.element:i,a=t.detail,s=a===void 0?{}:a,l=t.prefix,f=l===void 0?this.identifier:l,g=t.bubbles,O=g===void 0?!0:g,N=t.cancelable,M=N===void 0?!0:N,x=f?"".concat(f,":").concat(e):e,D=new CustomEvent(x,{detail:s,bubbles:O,cancelable:M});return o.dispatchEvent(D),D}}],[{key:"shouldLoad",get:function(){return!0}},{key:"afterLoad",value:function(e,t){}}]),r}();W.blessings=[Vt,Pt,Ut,Kt];W.targets=[];W.outlets=[];W.values={};export{Yt as A,W as C};
//# sourceMappingURL=stimulus-e54d982b.js.map
